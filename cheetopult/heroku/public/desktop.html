<!-- 
    Author: Mike Newell Â© 2012
-->
<!DOCTYPE html>
<html>
    <head>
        <title>iPhone</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
        <link rel="stylesheet" type="text/css" href="css/style-desktop.css" />
        
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/jquery.js"><\/script>')</script>
        <script src="js/requestAnimationFrame.js"></script>
        <script src="/socket.io/socket.io.js"></script>
        <script>
            var socket = io.connect('/');
            var theFlash;
            
            socket.on('hi', function (data) {
                socket.emit('hi back', { connection: 'desktop' });
            });
            
            /*
            *  NOTE: this is where my game logic should come into play and send commands to the flash file
            **/
            socket.on('accel', function(data) {
                console.log(data);
                var type = searchPNGName(data.png);
//                console.log(type);
                
                var distance = determineDistance(data.z);
//                theFlash.cheetoRed();

                initiateFlash(type, distance);

                console.log('type: ' + type + ' distance: ' + distance);
                
            });
            
            socket.on('new user', function(data) {
                theFlash.iphoneConnected();
            });
            
            var initiateFlash = function(t, d) {
                switch(t) {
                    case 'red':
                        switch(d) {
                            case 'close':
                                theFlash.redClose();
                                break;
                            case 'mouth':
                                theFlash.redMouth();
                                break;
                            case 'far':
                                theFlash.redFar();
                                break;
                        }
                        break;
                    case 'green':
                        switch(d) {
                            case 'close':
                                theFlash.greenClose();
                                break;
                            case 'mouth':
                                theFlash.greenMouth();
                                break;
                            case 'far':
                                theFlash.greenFar();
                                break;
                        }
                        break;
                    case 'yellow':
                        switch(d) {
                            case 'close':
                                theFlash.yellowClose();
                                break;
                            case 'mouth':
                                theFlash.yellowMouth();
                                break;
                            case 'far':
                                theFlash.yellowFar();
                                break;
                        }
                        break;
                    case 'orange':
                        switch(d) {
                            case 'close':
                                theFlash.orangeClose();
                                break;
                            case 'mouth':
                                theFlash.orangeMouth();
                                break;
                            case 'far':
                                theFlash.orangeFar();
                                break;
                        }
                        break;
                } // end switch
//                theFlash.playFlyingCheeto(t,d);
            };
            
            var determineDistance = function(z) {
                
                z = parseFloat(z);
                
                // close, far, mouth
                if(z < -6 && z > -12) {
                    return 'close';
                } else if(z < -12 && z > -15) {
                    return 'mouth';
                } else if(z < -15) {
                    return 'far';
                }
            };
            
            var searchPNGName = function(pngName) {
                if(pngName.search('red') > -1) {
                    return 'red';
                } else if(pngName.search('green') > -1) {
                    return 'green';
                } else if(pngName.search('yellow') > -1) {
                    return 'yellow';
                } else if(pngName.search('orange') > -1) {
                    return 'orange';
                }
            };
            
            $(window).load(function() {
                theFlash = document.getElementById("theFlash");
                
                console.log(theFlash);
                
//                setInterval(function() {
//                    
//                    if(typeof theFlash != "undefined") {
//                        theFlash.cheetoRed();
//                    } else {
//                        theFlash = document.getElementById("theFlash");
//                        theFlash.cheetoRed();
//                    }
//                    
//                    console.log("playing cheetoRed()");
//                }, 5000);
            });
        </script>
    </head>
    <body>
        <div id="wrap" style="width: 100%; height: 100%;">
            
            <!--[if !IE]>-->
            <object id="theFlash"  type="application/x-shockwave-flash" data="cheetopult.swf" width="100%" height="100%">
                <param name="movie" value="cheetopult.swf" />
                <param name="quality" value="high" />
                <param name="bgcolor" value="#ffffff" />
                <param name="play" value="true" />
                <param name="loop" value="true" />
                <param name="wmode" value="window" />
                <param name="scale" value="showall" />
                <param name="menu" value="true" />
                <param name="devicefont" value="false" />
                <param name="salign" value="" />
                <param name="allowScriptAccess" value="always" />
            <!--<![endif]-->
                <a href="http://www.adobe.com/go/getflash">
                    <img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe Flash player" />
                </a>
            <!--[if !IE]>-->
            </object>
            <!--<![endif]-->
            
            
        </div>
    </body>
</html>
